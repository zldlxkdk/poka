<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POKA 로그인/보안</title>
    <style>
        body { 
            font-family: 'Malgun Gothic', Arial, sans-serif; 
            margin: 0; 
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #222; 
            min-height: 100vh;
        }
        .header {
            background: rgba(255,255,255,0.95);
            padding: 20px 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        .header h1 {
            margin: 0;
            color: #2c3e50;
            font-size: 2.5em;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        .header p {
            margin: 10px 0 0 0;
            color: #7f8c8d;
            font-size: 1.1em;
        }
        .nav {
            background: rgba(255,255,255,0.95);
            padding: 15px 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .nav a {
            color: #3498db;
            text-decoration: none;
            margin: 0 15px;
            padding: 8px 15px;
            border-radius: 5px;
            transition: background 0.3s;
        }
        .nav a:hover {
            background: #3498db;
            color: white;
        }
        .container { 
            max-width: 1200px; 
            margin: 0 auto 40px auto; 
            background: #fff; 
            border-radius: 15px; 
            box-shadow: 0 8px 32px rgba(0,0,0,0.1); 
            padding: 40px;
            overflow: hidden;
        }
        h2 { 
            color: #3498db; 
            border-bottom: 3px solid #e9ecef; 
            padding-bottom: 10px; 
            margin-top: 0; 
            font-size: 1.8em;
        }
        h3 { 
            color: #2c3e50; 
            margin-top: 30px; 
            font-size: 1.4em;
        }
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .feature-card {
            background: #fff;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .feature-card h4 {
            color: #3498db;
            margin-top: 0;
        }
        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
            white-space: pre-wrap;
        }
        .security-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: #fff;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .security-table th {
            background: #3498db;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }
        .security-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e9ecef;
            vertical-align: top;
        }
        .security-table tr:hover {
            background: #f8f9fa;
        }
        .security-level {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
        }
        .level.high { background: #dc3545; color: white; }
        .level.medium { background: #ffc107; color: black; }
        .level.low { background: #28a745; color: white; }
        ul {
            margin: 0 0 20px 20px;
            line-height: 1.6;
        }
        .desc {
            color: #555;
            font-size: 1.1em;
            margin-bottom: 25px;
            line-height: 1.6;
        }
        .flow-diagram {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            text-align: center;
        }
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            .security-table {
                font-size: 0.9em;
            }
            .security-table th,
            .security-table td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>POKA 로그인/보안</h1>
        <p>포토카드 제작 키오스크 시스템 - 인증 및 보안 시스템</p>
    </div>

    <div class="nav">
        <a href="index.html">🏠 홈</a>
        <a href="01_시스템개요.html">🏗️ 시스템 개요</a>
        <a href="02_주요기능화면.html">📱 주요 기능/화면</a>
        <a href="03_URL_API목록.html">🌐 URL/API 목록</a>
        <a href="04_데이터구조.html">🗄️ 데이터 구조</a>
        <a href="06_결제업로드.html">💳 결제/업로드</a>
        <a href="07_운영관리.html">⚙️ 운영/관리</a>
        <a href="08_참고부록.html">📚 참고/부록</a>
    </div>

    <div class="container">
        <h2>로그인/보안</h2>
        <div class="desc">
            POKA 시스템은 <b>JWT 토큰 기반 인증</b>과 <b>다층 보안 정책</b>을 통해<br>
            시스템의 안전성과 사용자 데이터 보호를 보장합니다.
        </div>

        <h3>인증 시스템 개요</h3>
        <div class="feature-grid">
            <div class="feature-card">
                <h4>🔐 JWT 토큰 인증</h4>
                <ul>
                    <li><strong>토큰 기반:</strong> 서버리스 인증 방식</li>
                    <li><strong>만료 시간:</strong> 20분 (1200초)</li>
                    <li><strong>자동 갱신:</strong> 토큰 만료 5분 전 갱신</li>
                    <li><strong>Bearer 방식:</strong> Authorization 헤더 사용</li>
                </ul>
            </div>
            <div class="feature-card">
                <h4>👥 사용자 역할</h4>
                <ul>
                    <li><strong>admin:</strong> 시스템 관리자</li>
                    <li><strong>kiosk:</strong> 키오스크 운영자</li>
                    <li><strong>user:</strong> 일반 사용자</li>
                    <li><strong>guest:</strong> 게스트 사용자</li>
                </ul>
            </div>
            <div class="feature-card">
                <h4>🔒 보안 정책</h4>
                <ul>
                    <li><strong>HTTPS 강제:</strong> 모든 통신 암호화</li>
                    <li><strong>비밀번호 정책:</strong> 복잡도 요구사항</li>
                    <li><strong>세션 관리:</strong> 자동 로그아웃</li>
                    <li><strong>접근 제어:</strong> 역할 기반 권한</li>
                </ul>
            </div>
        </div>

        <h3>JWT 토큰 구조</h3>
        <div class="code-block">
<b>JWT 토큰 구성:</b>
Header.Payload.Signature

<b>Header (헤더):</b>
{
    "alg": "HS256",
    "typ": "JWT"
}

<b>Payload (페이로드):</b>
{
    "sub": "kiosk_user",
    "role": "kiosk",
    "iat": 1701423000,
    "exp": 1701424200,
    "jti": "unique_token_id"
}

<b>Signature (서명):</b>
HMACSHA256(
    base64UrlEncode(header) + "." +
    base64UrlEncode(payload),
    secret_key
)
        </div>

        <h3>인증 플로우</h3>
        <div class="flow-diagram">
1. 사용자 로그인 요청
   ↓
2. 사용자명/비밀번호 검증
   ↓
3. JWT 토큰 생성
   ↓
4. 토큰 응답 (20분 만료)
   ↓
5. API 요청 시 토큰 포함
   ↓
6. 토큰 검증 및 권한 확인
   ↓
7. API 응답
   ↓
8. 토큰 만료 5분 전 자동 갱신
        </div>

        <h3>보안 위험도 분석</h3>
        <table class="security-table">
            <tr>
                <th>위험 요소</th>
                <th>위험도</th>
                <th>대응 방안</th>
                <th>모니터링</th>
            </tr>
            <tr>
                <td>무차별 대입 공격</td>
                <td><span class="security-level level.high">HIGH</span></td>
                <td>로그인 시도 제한 (5회/5분)</td>
                <td>실시간 로그 모니터링</td>
            </tr>
            <tr>
                <td>토큰 탈취</td>
                <td><span class="security-level level.high">HIGH</span></td>
                <td>HTTPS 강제, 토큰 만료 시간 단축</td>
                <td>토큰 사용 패턴 분석</td>
            </tr>
            <tr>
                <td>세션 하이재킹</td>
                <td><span class="security-level level.medium">MEDIUM</span></td>
                <td>토큰 기반 인증, 자동 갱신</td>
                <td>비정상 접근 패턴 감지</td>
            </tr>
            <tr>
                <td>CSRF 공격</td>
                <td><span class="security-level level.medium">MEDIUM</span></td>
                <td>SameSite 쿠키, CSRF 토큰</td>
                <td>요청 출처 검증</td>
            </tr>
            <tr>
                <td>XSS 공격</td>
                <td><span class="security-level level.low">LOW</span></td>
                <td>입력값 검증, 출력 인코딩</td>
                <td>스크립트 태그 감지</td>
            </tr>
            <tr>
                <td>SQL 인젝션</td>
                <td><span class="security-level level.low">LOW</span></td>
                <td>파라미터화된 쿼리 사용</td>
                <td>SQL 패턴 감지</td>
            </tr>
        </table>

        <h3>비밀번호 정책</h3>
        <div class="feature-grid">
            <div class="feature-card">
                <h4>📏 복잡도 요구사항</h4>
                <ul>
                    <li><strong>최소 길이:</strong> 8자 이상</li>
                    <li><strong>대문자:</strong> 1개 이상 포함</li>
                    <li><strong>소문자:</strong> 1개 이상 포함</li>
                    <li><strong>숫자:</strong> 1개 이상 포함</li>
                    <li><strong>특수문자:</strong> 1개 이상 포함</li>
                </ul>
            </div>
            <div class="feature-card">
                <h4>🔄 비밀번호 관리</h4>
                <ul>
                    <li><strong>암호화:</strong> bcrypt 해시 (cost: 12)</li>
                    <li><strong>솔트:</strong> 자동 생성</li>
                    <li><strong>변경 주기:</strong> 90일 권장</li>
                    <li><strong>이력 관리:</strong> 최근 3개 비밀번호 재사용 금지</li>
                </ul>
            </div>
            <div class="feature-card">
                <h4>🔒 보안 강화</h4>
                <ul>
                    <li><strong>계정 잠금:</strong> 5회 실패 시 30분 잠금</li>
                    <li><strong>재시도 제한:</strong> 1분당 3회</li>
                    <li><strong>IP 기반 제한:</strong> 의심스러운 IP 차단</li>
                    <li><strong>2FA 지원:</strong> TOTP 기반 (선택사항)</li>
                </ul>
            </div>
        </div>

        <h3>권한 관리 시스템</h3>
        <div class="code-block">
<b>역할별 권한 매트릭스:</b>

┌─────────────┬─────────┬─────────┬─────────┬─────────┐
│   기능      │  admin  │  kiosk  │  user   │  guest  │
├─────────────┼─────────┼─────────┼─────────┼─────────┤
│ 로그인      │    ✓    │    ✓    │    ✓    │    ✓    │
│ 주문 생성   │    ✓    │    ✓    │    ✓    │    ✗    │
│ 결제 처리   │    ✓    │    ✓    │    ✗    │    ✗    │
│ 이미지 업로드│    ✓    │    ✓    │    ✓    │    ✓    │
│ 시스템 설정 │    ✓    │    ✗    │    ✗    │    ✗    │
│ 사용자 관리 │    ✓    │    ✗    │    ✗    │    ✗    │
│ 로그 조회   │    ✓    │    ✓    │    ✗    │    ✗    │
│ 통계 조회   │    ✓    │    ✓    │    ✗    │    ✗    │
└─────────────┴─────────┴─────────┴─────────┴─────────┘
        </div>

        <h3>세션 관리</h3>
        <div class="feature-grid">
            <div class="feature-card">
                <h4>⏰ 토큰 생명주기</h4>
                <ul>
                    <li><strong>발급:</strong> 로그인 성공 시</li>
                    <li><strong>유효기간:</strong> 20분 (1200초)</li>
                    <li><strong>갱신:</strong> 만료 5분 전 자동</li>
                    <li><strong>폐기:</strong> 로그아웃 시 즉시</li>
                </ul>
            </div>
            <div class="feature-card">
                <h4>🔄 자동 갱신 메커니즘</h4>
                <ul>
                    <li><strong>갱신 조건:</strong> 토큰 만료 5분 전</li>
                    <li><strong>갱신 방식:</strong> 백그라운드 갱신</li>
                    <li><strong>갱신 실패:</strong> 자동 로그아웃</li>
                    <li><strong>사용자 알림:</strong> 갱신 상태 표시</li>
                </ul>
            </div>
            <div class="feature-card">
                <h4>🚪 로그아웃 처리</h4>
                <ul>
                    <li><strong>토큰 무효화:</strong> 블랙리스트 등록</li>
                    <li><strong>세션 정리:</strong> 로컬 스토리지 삭제</li>
                    <li><strong>리다이렉트:</strong> 로그인 페이지로</li>
                    <li><strong>로그 기록:</strong> 로그아웃 이벤트</li>
                </ul>
            </div>
        </div>

        <h3>보안 모니터링</h3>
        <div class="code-block">
<b>보안 이벤트 로그:</b>

{
    "timestamp": "2024-12-01T10:30:00Z",
    "event": "LOGIN_ATTEMPT",
    "level": "INFO",
    "userId": "kiosk_user",
    "ipAddress": "192.168.1.100",
    "userAgent": "Mozilla/5.0...",
    "success": true,
    "details": {
        "loginMethod": "password",
        "sessionId": "sess_12345"
    }
}

<b>보안 경고 로그:</b>

{
    "timestamp": "2024-12-01T10:35:00Z",
    "event": "BRUTE_FORCE_DETECTED",
    "level": "WARNING",
    "ipAddress": "192.168.1.101",
    "attempts": 6,
    "timeWindow": "5 minutes",
    "action": "IP_BLOCKED",
    "details": {
        "blockDuration": "30 minutes",
        "reason": "Multiple failed login attempts"
    }
}
        </div>

        <h3>암호화 및 해시</h3>
        <div class="feature-grid">
            <div class="feature-card">
                <h4>🔐 비밀번호 해시</h4>
                <ul>
                    <li><strong>알고리즘:</strong> bcrypt</li>
                    <li><strong>비용 팩터:</strong> 12</li>
                    <li><strong>솔트:</strong> 자동 생성 (22자)</li>
                    <li><strong>해시 길이:</strong> 60자</li>
                </ul>
            </div>
            <div class="feature-card">
                <h4>🔑 JWT 서명</h4>
                <ul>
                    <li><strong>알고리즘:</strong> HMAC-SHA256</li>
                    <li><strong>키 길이:</strong> 256비트</li>
                    <li><strong>키 관리:</strong> 환경변수</li>
                    <li><strong>키 순환:</strong> 90일마다</li>
                </ul>
            </div>
            <div class="feature-card">
                <h4>🌐 HTTPS 설정</h4>
                <ul>
                    <li><strong>프로토콜:</strong> TLS 1.3</li>
                    <li><strong>인증서:</strong> Let's Encrypt</li>
                    <li><strong>HSTS:</strong> 1년 (31536000초)</li>
                    <li><strong>CSP:</strong> Content Security Policy</li>
                </ul>
            </div>
        </div>

        <h3>보안 헤더 설정</h3>
        <div class="code-block">
<b>보안 헤더 구성:</b>

Strict-Transport-Security: max-age=31536000; includeSubDomains
Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
X-XSS-Protection: 1; mode=block
Referrer-Policy: strict-origin-when-cross-origin
Permissions-Policy: geolocation=(), microphone=(), camera=()

<b>쿠키 보안 설정:</b>

Set-Cookie: session=abc123; 
    HttpOnly; 
    Secure; 
    SameSite=Strict; 
    Max-Age=1200; 
    Path=/
        </div>

        <h3>침입 탐지 및 대응</h3>
        <div class="feature-grid">
            <div class="feature-card">
                <h4>🚨 침입 탐지</h4>
                <ul>
                    <li><strong>패턴 분석:</strong> 비정상 접근 패턴 감지</li>
                    <li><strong>속도 제한:</strong> API 호출 빈도 제한</li>
                    <li><strong>지리적 제한:</strong> 허용된 IP 대역만</li>
                    <li><strong>행동 분석:</strong> 사용자 행동 패턴</li>
                </ul>
            </div>
            <div class="feature-card">
                <h4>🛡️ 자동 대응</h4>
                <ul>
                    <li><strong>IP 차단:</strong> 의심스러운 IP 자동 차단</li>
                    <li><strong>계정 잠금:</strong> 다중 실패 시 자동 잠금</li>
                    <li><strong>토큰 무효화:</strong> 보안 위반 시 토큰 폐기</li>
                    <li><strong>알림 발송:</strong> 관리자에게 보안 경고</li>
                </ul>
            </div>
            <div class="feature-card">
                <h4>📊 모니터링 대시보드</h4>
                <ul>
                    <li><strong>실시간 모니터링:</strong> 보안 이벤트 실시간 추적</li>
                    <li><strong>통계 분석:</strong> 보안 지표 대시보드</li>
                    <li><strong>경고 시스템:</strong> 임계값 초과 시 알림</li>
                    <li><strong>로그 분석:</strong> 보안 로그 분석 도구</li>
                </ul>
            </div>
        </div>
    </div>
</body>
</html>